##
# FastAPI Template API - Example Environment
#
# How to use locally (Docker Compose):
# - copy this file to `.env` (Docker Compose reads `.env` via `docker-compose.yml`)
#
# This file is intentionally verbose and includes:
# - "no production tightening" defaults (safe for local/dev/template usage)
# - "production tightening" recommended values (commented out; enable intentionally)
##

# Environment (no production tightening)
APP_ENV=local
DEBUG=false
APP_NAME=backend

# HTTP
APP_PORT=8000
API_PREFIX=

# Logging (recommended for prod too)
LOG_LEVEL=INFO
LOG_JSON=true
REQUEST_ID_HEADER=X-Request-ID

# Database / Redis
# - For local Docker Compose, these defaults work out of the box.
# - In production, set these to your managed services.
DATABASE_URL=postgresql+psycopg://app:app@postgres:5432/app
REDIS_URL=redis://redis:6379/0

# Auth / JWT
#
# No production tightening (local/test):
# - Keep the default `CHANGE_ME_IN_PROD` only in local/test environments.
#
# Production tightening (required outside local/test):
# - Set `JWT_SECRET_KEY` to a strong secret (32+ bytes recommended).
JWT_SECRET_KEY=CHANGE_ME_IN_PROD
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRES_MINUTES=60
JWT_ISSUER=
JWT_AUDIENCE=

# --- Production hardening (all optional; off by default) ---
# -----------------------------------------------------------

# # Rate limiting (Redis-backed; applied to /api/v1/* except health endpoints)
# # No production tightening default:
# # - keep OFF unless you explicitly want the guardrails enabled.
# RATE_LIMIT_ENABLED=false
# RATE_LIMIT_REQUESTS=60
# RATE_LIMIT_WINDOW_SECONDS=60
# RATE_LIMIT_KEY_STRATEGY=ip
# RATE_LIMIT_PREFIX=rl:

# # Cache (Redis-backed; demo: caches GET /api/v1/users/{id} for up to 60s)
# # No production tightening default:
# # - keep OFF unless you explicitly want caching enabled.
# CACHE_ENABLED=false
# CACHE_DEFAULT_TTL_SECONDS=300
# CACHE_PREFIX=cache:

# # Telemetry hooks (noop|log)
# # No production tightening default:
# # - noop: no overhead / no output
# # Production tightening recommended value:
# # - log: emits metrics as structured logs (good default "hook" for prod)
# TELEMETRY_MODE=noop
# TELEMETRY_SAMPLE_RATE=1.0

# -----------------------------------------------------------
# -----------------------------------------------------------
# -----------------------------------------------------------


# --- Production tightening examples (copy these into your real prod env) ---
# -----------------------------------------------------------

# Rate limiting ON (requires REDIS_URL):
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=60
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_KEY_STRATEGY=user_or_ip
#
# Cache ON (requires REDIS_URL):
CACHE_ENABLED=true
CACHE_DEFAULT_TTL_SECONDS=300
#
# Telemetry ON (log hook):
TELEMETRY_MODE=log
TELEMETRY_SAMPLE_RATE=1.0

# -----------------------------------------------------------
# -----------------------------------------------------------
# -----------------------------------------------------------


